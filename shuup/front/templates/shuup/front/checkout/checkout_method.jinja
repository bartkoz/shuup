{% extends "shuup/front/checkout/_base.jinja" %}
{% from "shuup/front/macros/general.jinja" import render_field with context %}

{% block checkout_phase_content %}
    <div class="row">
        {% set forms = form.forms %}
            <div class="col-md-6">
            <form role="form" method="post" action="">
                {% csrf_token %}
                {% set method_form = forms["checkout_method_choice"] %}
                {{ macros.render_field(method_form.register) }}
                {{ checkout_macros.default_buttons() }}
            </form>
            {% placeholder "checkout_method_choice_right" %}{% endplaceholder %}
        </div>
        <div class="col-md-6">
        <p class="collapse-element__header">Posiadasz konto? Kliknij <span>tutaj</span></p>
            <form class="single-page-refresh-after" role="form" method="post" action="">
                {% csrf_token %}
                {% set login_form = forms["login"] %}
                {% for error in login_form.non_field_errors() %}
                    {{ macros.alert(error, mode="danger") }}
                {% endfor %}
                {% for f in login_form.hidden_fields() %}{{ f }}{% endfor %}
                {% for f in login_form.visible_fields() %}{{ render_field(f) }}{% endfor %}
                <button type="submit" class="btn btn-primary btn-block" name="login">
                    <i class="fa fa-sign-in"></i> {% trans %}Log in{% endtrans %}
                </button>
                <hr>
                <a href="{{ url("shuup:recover_password") }}">
                    {% trans %}Forgot your password?{% endtrans %}
                </a>
            </form>
        </div>
    </div>
    {% placeholder "checkout_method_choice_bottom" %}{% endplaceholder %}
{% endblock %}

{% block extrajs %}
    {{ super() }}
    <script>
        $(function() {
            $(".selectpicker").selectpicker();
        });
    </script>
    <script>
    if (window.currentPhase === 'checkout_method') {
        var products = eval("{{ products }}")
        dataLayer.push({
            'event': 'pageview',
            'pageDomain': 'sklep.fishster.pl',
            'pageURL': '/checkout/checkout_method/',
            'pageType': 'checkout',
            'ecommerce': {
                'currencyCode': 'PLN',
                'checkout': {
                    'actionField': {'step': 2},
                    'products': products
                }
            }
        });
    }
    </script>
{% endblock %}
